{
  "name": "@ada/infra",
  "version": "0.0.0",
  "private": true,
  "license": "Apache-2.0",
  "main": "dist/index.js",
  "types": "dist/index.d.ts",
  "source": "src/index.ts",
  "scripts": {
    "compile": "ttsc",
    "type-check": "ttsc --noEmit",
    "prebuild": "yarn run copy:jwtsigner",
    "build": "yarn run compile",
    "postbuild": "yarn run build:images && yarn run copyfiles && yarn run dist:api-client-lambda",
    "get-deps": "cd src/services/data-product/components/schema-preview/dependencies && ./run-fetch.sh && cd -",
    "build:images": "yarn build:connectors:images && run-p build:image:schema-preview build:image:*",
    "build:image:schema-preview": "yarn run get-deps && yarn run build:image schema-preview src/services/data-product/components/schema-preview/docker-image",
    "build:image:start-data-product-infra-deployment": "yarn run build:image start-data-product-infra-deployment src/services/data-product/components/creation-state-machine/steps/start-data-product-infra-deployment",
    "build:connector:image": "ts-node -r tsconfig-paths/register scripts/build-connector-docker-image.ts",
    "build:connectors:images": "ts-node -r tsconfig-paths/register scripts/build-all-connector-docker-images.ts",
    "build:image": "ts-node scripts/build-docker-image.ts",
    "scan:images": "scripts/prepare-scan-docker-images.sh && run-p scan:image:*",
    "scan:image:schema-preview": "yarn run scan:image schema-preview src/services/data-product/components/schema-preview/docker-image",
    "scan:image:start-data-product-infra-deployment": "yarn run scan:image start-data-product-infra-deployment src/services/data-product/components/creation-state-machine/steps/start-data-product-infra-deployment",
    "scan:image": "./scripts/scan-docker-image.sh",
    "prejest-runner": "if-env-defined SKIP_CDK_OUT_TEST_RIMRAF || rimraf ./cdk.out.test",
    "jest-runner": "yarn node --max-old-space-size=16384 --expose-gc $(yarn bin jest) --runInBand",
    "test:dev": "yarn jest-runner --no-cache",
    "test:debug": "node $(yarn bin jest) --no-cache --runInBand",
    "test:node14": "yarn jest-runner --coverage --silent",
    "test": "docker run -v $(pwd)/../../..:/source -w /source -e SOURCE_DIR=$(dirname $(readlink -e $(pwd)/../../../../source)) public.ecr.aws/docker/library/node:14.21-bullseye /source/packages/@ada/infra/scripts/run-infra-tests.sh",
    "test:changed": "yarn run test --onlyChanged",
    "test:snapshots": "yarn test:dev stack -t snapshot",
    "test:snapshots:update": "yarn test:snapshots -u",
    "copyfiles": "yarn run copyfiles:nodejs && yarn run copyfiles:python",
    "copyfiles:nodejs": "copyfiles --all --follow -u 1 ./src/**/nodejs/** dist",
    "copyfiles:python": "copyfiles -u 1 -e **/htmlcov/** ./src/services/data-product/script-validation/** ./src/services/data-product/script-validation/handler/* dist",
    "copy:jwtsigner": "yarn run copyversion && yarn run copyfiles:jwtsigner",
    "copyversion": "ts-node scripts/copy-solution-version.ts",
    "copyfiles:jwtsigner": "copyfiles -u 3 ./src/common/jwt-signer/index.ts ./src/common/constructs/api/lambda-layer/code/nodejs/api-client-lambda/jwt-signer",
    "dist:api-client-lambda": "cd dist/common/constructs/api/lambda-layer/code/nodejs && rm -rf node_modules/@ada/api-client-lambda && mv api-client-lambda node_modules/@ada/",
    "test:nested": "run-s test:nested:* --",
    "test:nested:root": "yarn test:dev --config ./src/jest.config.ts",
    "test:nested:connectors": "yarn test:dev --config ./src/connectors/jest.config.ts",
    "test:nested:api": "yarn test:dev --config ./src/services/api/jest.config.ts",
    "test:nested:administration": "yarn test:dev --config ./src/services/administration/jest.config.ts",
    "test:nested:data-product": "yarn test:dev --config ./src/services/data-product/jest.config.ts",
    "test:nested:dynamic-infra": "yarn test:dev --config ./src/services/data-product/dynamic-infrastructure/jest.config.ts",
    "test:nested:governance": "yarn test:dev --config ./src/services/governance/jest.config.ts",
    "test:nested:identity": "yarn test:dev --config ./src/services/identity/jest.config.ts",
    "test:nested:notification": "yarn test:dev --config ./src/services/notification/jest.config.ts",
    "test:nested:ontology": "yarn test:dev --config ./src/services/ontology/jest.config.ts",
    "test:nested:query": "yarn test:dev --config ./src/services/query/jest.config.ts",
    "test:nested:query-parse-render": "yarn test:dev --config ./src/services/query-parse-render/jest.config.ts",
    "clean": "rm -rf ./dist",
    "generate:openapi:spec": "ts-node ./src/generator/openapi/generate-spec/task.ts",
    "dynamodb-local:find": "ps aux | grep -i sharedDb",
    "dynamodb-local:kill": "kill -9 $(yarn chore:find-ddb-processes | awk '{print $2}')",
    "dynamodb-local:uninstall": "rm -rf $TMPDIR/dynamodb-local"
  },
  "dependencies": {
    "@ada/api": "*",
    "@ada/athena-lens": "*",
    "@ada/athena-utilities": "*",
    "@ada/cdk-core": "*",
    "@ada/common": "*",
    "@ada/query-parse-render-lambdas": "*",
    "@ada/strings": "*",
    "@ada/transforms": "*",
    "@aws-cdk/aws-servicecatalogappregistry-alpha": "2.88.0-alpha.0",
    "@aws-sdk/util-arn-parser": "^3.310.0",
    "await-spawn": "^4.0.2",
    "aws-cdk-lib": "2.88.0",
    "aws-lambda-router": "0.11.0",
    "aws-xray-sdk": "^3.3.6",
    "aws4": "1.11.0",
    "bcryptjs": "^2.4.3",
    "common-tags": "^1.8.0",
    "constructs": "^10.1.181",
    "csp-header": "^5.1.0",
    "dynamodb-lock-client": "^0.7.3",
    "esbuild": "0",
    "http-status-codes": "^2.1.4",
    "isomorphic-fetch": "^3.0.0",
    "jsonwebtoken": "^9.0.0",
    "jwk-to-pem": "^2.0.5",
    "jwt-decode": "^3.1.2",
    "lambda-log": "^3.1.0",
    "lodash": "^4.17.21",
    "node-fetch": "^2.6.7",
    "query-string": "^7.1.1",
    "source-map-support": "^0.5.21",
    "uglify-js": "^3.15.3",
    "uuid": "^8.3.2",
    "verror": "^1.10.1",
    "yaml": "^2.2.2"
  },
  "devDependencies": {
    "@openapitools/openapi-generator-cli": "^2.4.1",
    "@types/bcryptjs": "^2.4.2",
    "@types/dynamodb-lock-client": "^0.7.1",
    "@types/isomorphic-fetch": "^0.0.35",
    "@types/jsonwebtoken": "^8.5.5",
    "@types/jwk-to-pem": "^2.0.1",
    "@types/lambda-log": "^2.2.1",
    "@types/string-hash": "^1.1.1",
    "@types/uglify-js": "^3.13.1",
    "@types/verror": "^1.10.5",
    "aws-cdk": "2.88.0",
    "aws-sdk": "^2.1358.0",
    "cdk-assets": "2.88.0",
    "cross-env": "^7.0.2",
    "execa": "^5.1.1",
    "find-port-free-sync": "^1.0.7",
    "jest-junit": "^14.0.0",
    "module-alias": "^2.2.2",
    "npm-run-all": "^4.1.5",
    "openapi-schema-validator": "^9.3.0",
    "promptly": "^3.2.0",
    "string-hash": "^1.1.3",
    "tsconfig-paths": "^4.1.0",
    "ttypescript": "^1.5.12"
  }
}
